<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ravenhill: The Case</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- –°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω -->
    <div id="start-screen" class="start-screen">
        <h1 class="start-title">RAVENHILL</h1>
        <p class="start-subtitle">THE CASE: EPISODE I</p>
        <button class="start-btn" onclick="startGame()">Enter the Manor</button>
    </div>

    <!-- –ò–≥—Ä–æ–≤–æ–µ –æ–∫–Ω–æ (—Å–∫—Ä—ã—Ç–æ –≤ –Ω–∞—á–∞–ª–µ) -->
    <div id="game-container" class="game-content" style="display: none;">
        <h2 id="scene-title">Loading...</h2>
        <div id="media-container" class="clue-media"></div>
        <div id="scene-text"></div>
        <div id="choices-container" class="choices"></div>

        <div class="panels-container">
            <div class="mini-english">
                <h3>üîç Mini-English</h3>
                <div id="dictionary-display"></div>
            </div>
            <div class="status">
                <h3>üíº Status</h3>
                <div id="score-display">Score: 0</div>
                <div id="inventory-display">Inventory: empty</div>
            </div>
        </div>
    </div>

    <!-- –ó–≤—É–∫–∏ (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –æ–Ω–∏ –µ—Å—Ç—å –≤ assets) -->
    <audio id="bgMusic" loop src="assets/mystery-loop.mp3"></audio>
    <audio id="uiClick" src="assets/click1.wav"></audio>
    <audio id="radioSound" src="assets/radio-message.wav"></audio>
    <audio id="diary-voice" src="assets/diary-voice.mp3"></audio>

   <script>
// --- –í–°–Ø –õ–û–ì–ò–ö–ê –ò–ì–†–´ –ü–†–Ø–ú–û –ó–î–ï–°–¨ ---
let inventory = new Set();
let score = 0;

function startGame() {
    const startScreen = document.getElementById('start-screen');
    const gameContent = document.getElementById('game-container');
    if (startScreen) startScreen.style.display = 'none';
    if (gameContent) gameContent.style.display = 'block';
    
    // –ü—ã—Ç–∞–µ–º—Å—è –≤–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É
    const music = document.getElementById('bgMusic');
    if (music) music.play().catch(e => console.log("Music blocked"));
    
    renderScene('scene1');
}

// –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
window.onload = function() {
    const btn = document.querySelector('.start-btn');
    if (btn) btn.onclick = startGame;
};

// –û–±—ä–µ–∫—Ç —Å–æ –≤—Å–µ–º–∏ –≤–∞—à–∏–º–∏ —Å—Ü–µ–Ω–∞–º–∏ –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ –∫–æ–¥–∞
const scenes = {
    scene1: {
        title: 'Episode I ¬∑ The Summons',
        text: 'You stand before the gates of Ravenhill. They are locked. You need to <b>find out</b> how to enter.',
        task: {
            question: 'What does "find out" mean?',
            options: ['To discover information', 'To close the gate'],
            correct: 'To discover information',
            reward: 'access_hint'
        },
        english: '<b>Find out</b> ‚Äî –≤—ã—è—Å–Ω–∏—Ç—å, —Ä–∞–∑—É–∑–Ω–∞—Ç—å.',
        media: '<img src="assets/gates.png" class="clue-img">',
        choices: [
            { text: 'Search the Garden', next: 'scene_garden' },
            { text: 'Use Radio Hint', next: 'scene_radio', require: 'access_hint' }
        ]
    },
    scene_radio: {
        title: 'Radio Message',
        text: 'Static noise... then a voice: "Detective, check the garden!"',
        media: '<video src="assets/radio-scene.mp4" autoplay loop muted class="clue-img"></video>',
        choices: [{ text: 'Go to the Garden', next: 'scene_garden' }]
    },
    scene_garden: {
        title: 'The Silent Garden',
        text: 'Among the withered roses, you see a wooden box.',
        media: '<img src="assets/garden.png" class="clue-img">',
        choices: [{ text: 'Open the box', next: 'scene_box_task' }]
    },
    scene_box_task: {
        title: 'The Mysterious Box',
        text: 'The box is locked. "The detective decided to _____ into the room."',
        task: {
            question: 'Which phrasal verb means "to enter"?',
            options: ['Go out', 'Go in'],
            correct: 'Go in',
            reward: 'silver_key'
        },
        media: '<img src="assets/box.png" class="clue-img">',
        choices: [{ text: 'Go back to Gates', next: 'scene1', require: 'silver_key' }]
    }
    // ... –≤—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å —Å—é–¥–∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ü–µ–Ω—ã –ø–æ–∑–∂–µ
};

function renderScene(sceneId) {
    const scene = scenes[sceneId];
    if (!scene) return;

    document.getElementById('scene-title').innerText = scene.title;
    document.getElementById('scene-text').innerHTML = scene.text;
    document.getElementById('media-container').innerHTML = scene.media || '';
    document.getElementById('dictionary-display').innerHTML = scene.english || '';
    
    const choiceBox = document.getElementById('choices-container');
    choiceBox.innerHTML = '';

    if (scene.task && !inventory.has(scene.task.reward)) {
        renderTask(scene.task, choiceBox, sceneId);
    } else {
        scene.choices.forEach(c => {
            if (!c.require || inventory.has(c.require)) {
                const b = document.createElement('button');
                b.className = 'choice-btn';
                b.innerText = c.text;
                b.onclick = () => renderScene(c.next);
                choiceBox.appendChild(b);
            }
        });
    }
}

function renderTask(task, container, sceneId) {
    const p = document.createElement('p');
    p.innerHTML = `<b>TASK:</b> ${task.question}`;
    container.appendChild(p);
    task.options.forEach(opt => {
        const b = document.createElement('button');
        b.className = 'choice-btn';
        b.innerText = opt;
        b.onclick = () => {
            if (opt === task.correct) {
                inventory.add(task.reward);
                renderScene(sceneId);
            } else {
                alert("Wrong!");
            }
        };
        container.appendChild(b);
    });
}
</script>

</body>
</html>
